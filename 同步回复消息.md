``WxMessageRouter``默认使用异步的方式处理消息，如果要使用同步回复微信消息，那么需要将路由规则配置为同步，且handler需要返回一个``WxXmlOutMessage``：

```java
// 某个handler
public WxXmlOutMessage handle(WxXmlMessage wxMessage, Map<String, Object> context) {
  // ...
  return WxXmlOutMessage.TEXT().content("content").fromUser("from").touser("to").build();
}
```

```java
router
  .rule()
    .async(false)
    .handler(handler)
  .end()
;

// 将WxXmlMessage交给消息路由器
HttpServletRequest request = ...;
WxXmlMessage inMsg = WxXmlMessage.fromXml(request.getInputStream());
WxXmlOutMessage reMsg = router.route(inMsg);
if (reMsg != null) {
  // 说明是同步回复的消息
  // ... 将xml写入HttpServletResponse
} else {
  // 说明是异步回复的消息，直接将空字符串写入HttpServletResponse
}
```

## WxXmlOutTextMessage

``WxXmlOutTextMessage``是同步回复给微信消息的对象，不同类型的消息类型可以用不同的方式构造：

### 文本消息

```java
WxXmlOutMessage.TEXT()
  .content("content")
  .fromUser("from")
  .touser("to")
  .build();
```

### 图片消息

```java
WxXmlOutMessage.IMAGE()
  .mediaId("ddfefesfsdfef")
  .fromUser("from")
  .touser("to")
  .build();
```

### 语音消息

```java
WxXmlOutMessage.VOICE()
  .mediaId("ddfefesfsdfef")
  .fromUser("from")
  .touser("to")
  .build();
```

### 视频消息

```java
WxXmlOutMessage.VIDEO()
  .mediaId("media_id")
  .fromUser("fromUser")
  .touser("toUser")
  .title("title")
  .description("ddfff")
  .build();
```

### 图文消息

```java
WxXmlOutMewsMessage.Item item = new WxXmlOutMewsMessage.Item();
item.setDescription("description");
item.setPicUrl("picUrl");
item.setTitle("title");
item.setUrl("url");
    
WxXmlOutMewsMessage m = WxXmlOutMessage.NEWS()
  .fromUser("fromUser")
  .touser("toUser")
  .addArticle(item)
  .build();
```
